"use strict";(self.webpackChunkFrontend_ASIA_DEPOT=self.webpackChunkFrontend_ASIA_DEPOT||[]).push([[247],{2247:(j,A,a)=>{a.r(A),a.d(A,{AdminProfileModule:()=>Y});var v=a(6895),i=a(433),c=a(5808),d=a(1548),e=a(8256),b=a(9616),_=a(7638),E=a(69),Z=a(6428),P=a(4554),T=a(7482);function U(r,l){if(1&r&&(e.TgZ(0,"div",14)(1,"label",28)(2,"strong"),e._uU(3,"NIT"),e.qZA()(),e.TgZ(4,"p",29),e._uU(5),e.qZA()()),2&r){const o=e.oxw();e.xp6(5),e.Oqu(o.employee.NIT_Empleado)}}function S(r,l){if(1&r&&(e.TgZ(0,"button",31),e._uU(1,"Subir Foto"),e.qZA()),2&r){const o=e.oxw();e.Q6J("disabled",o.uploading)}}function x(r,l){1&r&&(e.TgZ(0,"button",32),e._UZ(1,"span",33),e._uU(2," Cargando... "),e.qZA())}function I(r,l){1&r&&(e.TgZ(0,"div",34),e._uU(1," El nombre es demasiado corto (m\xednimo 3 car\xe1cteres). "),e.qZA())}function w(r,l){1&r&&(e.TgZ(0,"div",34),e._uU(1," El nombre es demasiado largo (m\xe1ximo 30 car\xe1cteres). "),e.qZA())}function F(r,l){1&r&&(e.TgZ(0,"div",34),e._uU(1," El nombre no es v\xe1lido, no use car\xe1cteres especiales. "),e.qZA())}function C(r,l){1&r&&(e.TgZ(0,"div",34),e._uU(1," El apellido es demasiado corto (m\xednimo 3 car\xe1cteres). "),e.qZA())}function q(r,l){1&r&&(e.TgZ(0,"div",34),e._uU(1," El apellido es demasiado largo (m\xe1ximo 30 car\xe1cteres). "),e.qZA())}function N(r,l){1&r&&(e.TgZ(0,"div",34),e._uU(1," El apellido no es v\xe1lido, no use car\xe1cteres especiales. "),e.qZA())}function R(r,l){1&r&&(e.TgZ(0,"div",34),e._uU(1," El tel\xe9fono no es v\xe1lido, debe de poseer 8 d\xedgitos. "),e.qZA())}function z(r,l){1&r&&(e.TgZ(0,"div",34),e._uU(1," El NIT no es v\xe1lido. "),e.qZA())}const O=[{path:"",redirectTo:"profile",pathMatch:"full"},{path:"profile",component:(()=>{class r{constructor(o,t,n,s){this.authService=o,this.adminService=t,this.sharedService=n,this.customAlertService=s,this.employee={},this.image="assets/transparent.png",this.pathRole=""}ngOnInit(){this.viewProfile(),this.getProfilePicture()}isSuperAdmin(){return"SuperAdmin"===this.authService.getCookieRole()?(this.pathRole="superAdmin",!0):(this.pathRole="admin",!1)}viewProfile(){try{this.isSuperAdmin(),this.adminService.getEmployeeProfile(`${d.Q}/${this.pathRole}/ver/perfil`).subscribe({next:o=>{this.employee=o.employee},error:o=>{this.customAlertService.sweetAlertPersonalizada("error","Error",o.error.error)}})}catch(o){console.log(o.error)}}getProfilePicture(){try{this.isSuperAdmin(),this.adminService.getProfilePhoto(`${d.Q}/${this.pathRole}/ver/avatar`).subscribe({next:o=>{this.image=URL.createObjectURL(o)},error:o=>{this.image="assets/perfil_picture.png"}})}catch(o){console.log(o.error)}}deleteProfilePicture(){try{this.adminService.deleteProfilePhoto(`${d.Q}/${this.pathRole}/eliminar/avatar`).subscribe({next:o=>{this.image="assets/perfil_picture.png",this.customAlertService.sweetAlertPersonalizada("success","Exitoso",o.msg),this.sharedService.profileImageUpdated.emit("assets/perfil_picture.png")},error:o=>{this.customAlertService.sweetAlertPersonalizada("error","Error",o.error.error)}})}catch(o){console.log(o.error)}}logout(){try{this.authService.logout().subscribe({next:o=>{this.customAlertService.sweetAlertPersonalizada("success","Exitoso",o.msg),this.authService.deleteCookie()},error:o=>{this.customAlertService.sweetAlertPersonalizada("error","Error",o.error.error)}})}catch(o){console.log(o.error)}}logoutAll(){try{this.authService.logoutAll().subscribe({next:o=>{this.customAlertService.sweetAlertPersonalizada("success","Exitoso",o.msg),this.authService.deleteCookie()},error:o=>{this.customAlertService.sweetAlertPersonalizada("error","Error",o.error.error)}})}catch(o){console.log(o.error)}}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(b.e),e.Y36(_.a),e.Y36(E.F),e.Y36(Z.y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-profile"]],decls:62,vars:9,consts:[["id","main-content"],[1,"d-flex","justify-content-center"],[1,"col-md-9","mt-4"],[1,"container"],[1,"row","d-flex","justify-content-center"],[1,"col-md-9","colorEdit","shadow-lg","rounded-5","mb-3"],[1,"d-flex","flex-column","flex-md-row","align-items-center","justify-content-center"],[1,"col-md-4"],["width","70%","alt","Foto-Perfil",1,"img-fluid","rounded-circle",3,"src"],[1,"col-md-6"],[1,"col-md-9","mb-5"],[1,"d-flex","flex-column","flex-md-row","align-items-center","justify-content-between"],[1,"col-md-6","colorEdit","shadow-lg","rounded-5","p-5","mb-5","container-info"],[1,"mb-4"],[1,"mb-3"],["for","nombre"],["id","nombre"],["for","apellido"],["id","apellido"],["for","correo"],["id","correo"],["for","telefono"],["id","telefono"],["class","mb-3",4,"ngIf"],[1,"col-md-5","colorEdit","shadow-lg","rounded-5","p-5"],[1,"d-flex","flex-column","btnAction"],[1,"btn","btn-primary","btn-block",3,"routerLink"],[1,"btn","btn-danger","btn-block",3,"click"],["for","nit"],["id","nit"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0),e._UZ(1,"app-nav-bar"),e.TgZ(2,"section",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7),e._UZ(9,"img",8),e.qZA(),e.TgZ(10,"div",9)(11,"h1"),e._uU(12),e.qZA(),e.TgZ(13,"h1"),e._uU(14),e.qZA()()()(),e.TgZ(15,"div",10)(16,"div",11)(17,"div",12)(18,"h3",13),e._uU(19,"Informaci\xf3n personal"),e.qZA(),e.TgZ(20,"div",14)(21,"label",15)(22,"strong"),e._uU(23,"Nombre"),e.qZA()(),e.TgZ(24,"p",16),e._uU(25),e.qZA()(),e.TgZ(26,"div",14)(27,"label",17)(28,"strong"),e._uU(29,"Apellido"),e.qZA()(),e.TgZ(30,"p",18),e._uU(31),e.qZA()(),e.TgZ(32,"div",14)(33,"label",19)(34,"strong"),e._uU(35,"Correo"),e.qZA()(),e.TgZ(36,"p",20),e._uU(37),e.qZA()(),e.TgZ(38,"div",14)(39,"label",21)(40,"strong"),e._uU(41,"Tel\xe9fono"),e.qZA()(),e.TgZ(42,"p",22),e._uU(43),e.qZA()(),e.YNc(44,U,6,1,"div",23),e.qZA(),e.TgZ(45,"div",24)(46,"h3",13),e._uU(47,"Acciones"),e.qZA(),e.TgZ(48,"div",25)(49,"div",14)(50,"a",26),e._uU(51,"Actualizar Datos"),e.qZA()(),e.TgZ(52,"div",14)(53,"a",27),e.NdJ("click",function(){return t.deleteProfilePicture()}),e._uU(54,"Borrar Foto de Perfil"),e.qZA()(),e.TgZ(55,"div",14)(56,"a",27),e.NdJ("click",function(){return t.logout()}),e._uU(57,"Cerrar Sesi\xf3n"),e.qZA()(),e.TgZ(58,"div",14)(59,"a",27),e.NdJ("click",function(){return t.logoutAll()}),e._uU(60,"Cerrar Todas las Sesiones"),e.qZA()()()()()()()(),e._UZ(61,"app-footer"),e.qZA()()()),2&o&&(e.xp6(9),e.s9C("src",t.image,e.LSH),e.xp6(3),e.Oqu(t.employee.Nombre_Empleado),e.xp6(2),e.Oqu(t.employee.Apellido_Empleado),e.xp6(11),e.Oqu(t.employee.Nombre_Empleado),e.xp6(6),e.Oqu(t.employee.Apellido_Empleado),e.xp6(6),e.Oqu(t.employee.Correo_Empleado),e.xp6(6),e.Oqu(t.employee.Telefono_Empleado),e.xp6(1),e.Q6J("ngIf",t.employee.NIT_Empleado),e.xp6(6),e.Q6J("routerLink","/admin/profile/update"))},dependencies:[v.O5,c.rH,P.w,T.c],styles:[".btnAction[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{max-width:300px;width:100%}.colorEdit[_ngcontent-%COMP%]{background-color:#d4d4de}"]}),r})()},{path:"profile/update",component:(()=>{class r{constructor(o,t,n,s,u){this.fb=o,this.authService=t,this.adminService=n,this.customAlertService=s,this.router=u,this.employee={},this.image="assets/transparent.png",this.uploading=!1,this.previewImage=null,this.pathRole="",this.loading=!1,this.validateForm()}isSuperAdmin(){return"SuperAdmin"===this.authService.getCookieRole()?(this.pathRole="superAdmin",!0):(this.pathRole="admin",!1)}ngOnInit(){this.scrollToTop(),this.isSuperAdmin(),this.viewProfile(),this.getProfilePicture()}viewProfile(){try{this.isSuperAdmin(),this.adminService.getEmployeeProfile(`${d.Q}/${this.pathRole}/ver/perfil`).subscribe({next:o=>{this.employee=o.employee},error:o=>{this.customAlertService.sweetAlertPersonalizada("error","Error",o.error.error)}})}catch(o){console.log(o.error)}}validateForm(){this.updateForm=new i.cw({nombre:new i.NI("",[i.kI.pattern(/^[a-zA-Z\xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda\xf1\xd1\xfc\xdc\s]+$/),i.kI.minLength(3),i.kI.maxLength(30)]),apellido:new i.NI("",[i.kI.pattern(/^[a-zA-Z\xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda\xf1\xd1\xfc\xdc\s]+$/),i.kI.minLength(3),i.kI.maxLength(30)]),telefono:new i.NI("",[i.kI.pattern(/^[345][0-9]{7}$/)]),nit:new i.NI("",[i.kI.pattern("^[0-9]+$")])})}getUserData(){const o={Nombre_Empleado:this.updateForm.get("nombre")?.value,Apellido_Empleado:this.updateForm.get("apellido")?.value,Telefono_Empleado:this.updateForm.get("telefono")?.value,NIT_Empleado:this.updateForm.get("nit")?.value};for(const t in o)o.hasOwnProperty(t)&&(null==o[t]||""===o[t])&&delete o[t];return 0===Object.keys(o).length?null:o}onSubmit(){try{if(this.updateForm.valid){const o=this.getUserData();o?this.adminService.updateEmployee(`${d.Q}/${this.pathRole}/actualizar/perfil`,o).subscribe({next:t=>{this.customAlertService.sweetAlertPersonalizada("success","Exitoso",t.msg),this.updateForm.reset(),this.router.navigate(["/admin/profile"])},error:t=>{this.customAlertService.sweetAlertPersonalizada("error","Error",t.error.error)}}):(this.customAlertService.sweetAlertPersonalizada("success","Sin cambios","No has realizado ning\xfan cambio."),this.router.navigate(["/admin/profile"]))}else this.customAlertService.sweetAlertPersonalizada("error","Error","Por favor, verifica los campos del formulario.")}catch(o){console.log(o.error)}}getProfilePicture(){try{this.isSuperAdmin(),this.adminService.getProfilePhoto(`${d.Q}/${this.pathRole}/ver/avatar`).subscribe({next:o=>{this.image=URL.createObjectURL(o)},error:o=>{this.image="assets/perfil_picture.png"}})}catch(o){console.log(o.error)}}onUploadAvatar(){try{this.selectedFile?(this.uploading=!0,this.loading=!0,this.isSuperAdmin(),this.adminService.uploadProfilePhoto(`${d.Q}/${this.pathRole}/subir/avatar`,this.selectedFile).subscribe({next:o=>{this.uploading=!1,this.loading=!1,this.customAlertService.sweetAlertPersonalizada("success","Exitoso",o.msg),this.router.navigate(["admin/profile"])},error:o=>{this.uploading=!1,this.customAlertService.sweetAlertPersonalizada("error","Error",o.error.error)}})):this.customAlertService.sweetAlertPersonalizada("error","Im\xe1gen no seleccionada","Por favor selecciona una im\xe1gen.")}catch(o){console.log(o.error)}}onFileSelected(o){const t=o.target;if(t.files&&t.files.length>0){const n=t.files[0],s=n.name.split(".").pop()?.toLowerCase();if(s)if(["jpg","jpeg","png"].includes(s)){this.selectedFile=n;const m=new FileReader;m.onload=p=>{this.previewImage=p.target?.result},m.readAsDataURL(n)}else this.customAlertService.sweetAlertPersonalizada("error","Archivo no v\xe1lido","Selecciona un archivo con una extensi\xf3n v\xe1lida (.jpg, .jpeg o .png).");else this.customAlertService.sweetAlertPersonalizada("error","Archivo no v\xe1lido","No se pudo determinar la extensi\xf3n del archivo.")}}scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(i.qu),e.Y36(b.e),e.Y36(_.a),e.Y36(Z.y),e.Y36(c.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-update-profile"]],decls:52,vars:16,consts:[["id","main-content"],[1,"d-flex","justify-content-center"],[1,"container","mt-5"],[1,"row"],[1,"col-md-12","mb-4"],[1,"d-flex","flex-column","flex-md-row","align-items-center","justify-content-center"],[1,"col-md-4","colorEdit","shadow-lg","rounded-5","p-5","mb-5",2,"margin-right","20px"],["alt","Foto de Perfil",1,"img-fluid","rounded-circle",2,"max-width","250px","max-height","250px",3,"src"],[3,"ngSubmit"],[1,"mt-3"],[1,"form-group"],["id","formFile","type","file","accept",".png, .jpg, .jpeg","name","avatar","required","",1,"mt-3","form-control",3,"change"],[1,"row","mb-4"],[1,"col-md-12","d-flex","justify-content-center","mt-4"],["type","submit","class","btn btn-primary",3,"disabled",4,"ngIf"],["type","button","class","btn btn-primary","disabled","",4,"ngIf"],[1,"col-md-5","colorEdit","shadow-lg","rounded-5","p-5","mb-5"],[1,"text-center","mb-4"],[3,"formGroup","ngSubmit"],[1,"form-floating","mb-3"],["type","text","formControlName","nombre","placeholder","Ingresa tu nombre",1,"form-control"],["for","registerName"],["class","text-danger",4,"ngIf"],["type","text","formControlName","apellido","placeholder","Ingresa tu apellido",1,"form-control"],["for","registerUsername"],["type","text","formControlName","telefono","placeholder","Ingresa tu n\xfamero de tel\xe9fono",1,"form-control"],["for","registerTel"],["type","number","formControlName","nit","placeholder","Ingresa tu NIT",1,"form-control"],["for","registerNIT"],[1,"col-md-12","d-flex","justify-content-center","mt-3"],["type","submit",1,"btn","btn-primary","btn-block","w-75"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button","disabled","",1,"btn","btn-primary"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],[1,"text-danger"]],template:function(o,t){if(1&o&&(e.TgZ(0,"div",0),e._UZ(1,"app-nav-bar"),e.TgZ(2,"section",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",1),e._UZ(9,"img",7),e.qZA(),e.TgZ(10,"form",8),e.NdJ("ngSubmit",function(){return t.onUploadAvatar()}),e.TgZ(11,"div",9)(12,"div",10)(13,"input",11),e.NdJ("change",function(s){return t.onFileSelected(s)}),e.qZA()(),e.TgZ(14,"div",12)(15,"div",13),e.YNc(16,S,2,1,"button",14),e.YNc(17,x,3,0,"button",15),e.qZA()()()()(),e.TgZ(18,"div",16)(19,"div",17)(20,"h2"),e._uU(21,"Actualizar datos personales"),e.qZA()(),e.TgZ(22,"form",18),e.NdJ("ngSubmit",function(){return t.onSubmit()}),e.TgZ(23,"div",19),e._UZ(24,"input",20),e.TgZ(25,"label",21),e._uU(26),e.qZA(),e.YNc(27,I,2,0,"div",22),e.YNc(28,w,2,0,"div",22),e.YNc(29,F,2,0,"div",22),e.qZA(),e.TgZ(30,"div",19),e._UZ(31,"input",23),e.TgZ(32,"label",24),e._uU(33),e.qZA(),e.YNc(34,C,2,0,"div",22),e.YNc(35,q,2,0,"div",22),e.YNc(36,N,2,0,"div",22),e.qZA(),e.TgZ(37,"div",19),e._UZ(38,"input",25),e.TgZ(39,"label",26),e._uU(40),e.qZA(),e.YNc(41,R,2,0,"div",22),e.qZA(),e.TgZ(42,"div",19),e._UZ(43,"input",27),e.TgZ(44,"label",28),e._uU(45),e.qZA(),e.YNc(46,z,2,0,"div",22),e.qZA(),e.TgZ(47,"div",12)(48,"div",29)(49,"button",30),e._uU(50,"Actualizar datos"),e.qZA()()()()()()()(),e._UZ(51,"app-footer"),e.qZA()()()),2&o){let n,s,u,m,p,f,g,h;e.xp6(9),e.s9C("src",t.previewImage||t.image,e.LSH),e.xp6(7),e.Q6J("ngIf",!1===t.loading),e.xp6(1),e.Q6J("ngIf",!0===t.loading),e.xp6(5),e.Q6J("formGroup",t.updateForm),e.xp6(4),e.Oqu(t.employee.Nombre_Empleado||"Ingresa tu nombre"),e.xp6(1),e.Q6J("ngIf",(null==(n=t.updateForm.get("nombre"))?null:n.hasError("minlength"))&&(null==(n=t.updateForm.get("nombre"))?null:n.touched)),e.xp6(1),e.Q6J("ngIf",(null==(s=t.updateForm.get("nombre"))?null:s.hasError("maxlength"))&&(null==(s=t.updateForm.get("nombre"))?null:s.touched)),e.xp6(1),e.Q6J("ngIf",(null==(u=t.updateForm.get("nombre"))?null:u.hasError("pattern"))&&(null==(u=t.updateForm.get("nombre"))?null:u.touched)),e.xp6(4),e.Oqu(t.employee.Apellido_Empleado||"Ingresa tu apellido"),e.xp6(1),e.Q6J("ngIf",(null==(m=t.updateForm.get("apellido"))?null:m.hasError("minlength"))&&(null==(m=t.updateForm.get("apellido"))?null:m.touched)),e.xp6(1),e.Q6J("ngIf",(null==(p=t.updateForm.get("apellido"))?null:p.hasError("maxlength"))&&(null==(p=t.updateForm.get("apellido"))?null:p.touched)),e.xp6(1),e.Q6J("ngIf",(null==(f=t.updateForm.get("apellido"))?null:f.hasError("pattern"))&&(null==(f=t.updateForm.get("apellido"))?null:f.touched)),e.xp6(4),e.Oqu(t.employee.Telefono_Empleado||"Ingresa tu tel\xe9fono"),e.xp6(1),e.Q6J("ngIf",(null==(g=t.updateForm.get("telefono"))?null:g.hasError("pattern"))&&(null==(g=t.updateForm.get("telefono"))?null:g.touched)),e.xp6(4),e.Oqu(t.employee.NIT_Empleado||"Ingresa tu NIT"),e.xp6(1),e.Q6J("ngIf",(null==(h=t.updateForm.get("nit"))?null:h.hasError("pattern"))&&(null==(h=t.updateForm.get("nit"))?null:h.touched))}},dependencies:[v.O5,i._Y,i.Fj,i.wV,i.JJ,i.JL,i.sg,i.u,i.F,P.w,T.c],styles:[".colorEdit[_ngcontent-%COMP%]{background-color:#d4d4de}"]}),r})()}];let J=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[c.Bz.forChild(O),c.Bz]}),r})();var Q=a(592);let Y=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[v.ez,i.UX,i.u5,J,Q.g]}),r})()}}]);